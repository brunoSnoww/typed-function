"use strict";!function(n,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():n.typed=t()}(this,function(){function O(){return!0}function an(){return!1}function on(){}return function n(){var t=[{name:"number",test:function(n){return"number"==typeof n}},{name:"string",test:function(n){return"string"==typeof n}},{name:"boolean",test:function(n){return"boolean"==typeof n}},{name:"Function",test:function(n){return"function"==typeof n}},{name:"Array",test:Array.isArray},{name:"Date",test:function(n){return n instanceof Date}},{name:"RegExp",test:function(n){return n instanceof RegExp}},{name:"Object",test:function(n){return"object"==typeof n&&null!==n&&n.constructor===Object}},{name:"null",test:function(n){return null===n}},{name:"undefined",test:function(n){return void 0===n}}],r={name:"any",test:O},e=[],a=[],z={types:t,conversions:a,ignore:e};function u(t){var n=nn(z.types,function(n){return n.name===t});if(n)return n;if("any"===t)return r;throw n=nn(z.types,function(n){return n.name.toLowerCase()===t.toLowerCase()}),new TypeError('Unknown type "'+t+'"'+(n?'. Did you mean "'+n.name+'"?':""))}function i(n){return n===r?999:z.types.indexOf(n)}function c(t){var n=nn(z.types,function(n){return n.test(t)});if(n)return n.name;throw new TypeError("Value has unknown type. Value: "+t)}function B(n){return n.map(function(n){var t=n.types.map(o);return(n.restParam?"...":"")+t.join("|")}).join(",")}function G(n,r){var t,e,a=0===n.indexOf("..."),n=(a?3<n.length?n.slice(3):"any":n).split("|").map(Z).filter(j).filter(E),o=(t=n,e={},r.forEach(function(n){-1!==t.indexOf(n.from)||-1===t.indexOf(n.to)||e[n.from]||(e[n.from]=n)}),Object.keys(e).map(function(n){return e[n]})),n=n.map(function(n){var t=u(n);return{name:n,typeIndex:i(t),test:t.test,conversion:null,conversionIndex:-1}}),o=o.map(function(n){var t=u(n.from);return{name:n.from,typeIndex:i(t),test:t.test,conversion:n,conversionIndex:r.indexOf(n)}});return{types:n.concat(o),restParam:a}}function H(n){return!!(n=v(n))&&n.restParam}function J(n){return n.types.some(function(n){return null!=n.conversion})}function K(n){var t,r,e;return n&&0!==n.types.length?1===n.types.length?u(n.types[0].name).test:2===n.types.length?(t=u(n.types[0].name).test,r=u(n.types[1].name).test,function(n){return t(n)||r(n)}):(e=n.types.map(function(n){return u(n.name).test}),function(n){for(var t=0;t<e.length;t++)if(e[t](n))return!0;return!1}):O}function Q(n){var t,r,e,a,o,i;return H(n)?(a=(e=(i=n).slice(0,i.length-1).map(K)).length,o=K(v(n)),function(n){for(var t=0;t<e.length;t++)if(!e[t](n[t]))return!1;return function(n){for(var t=a;t<n.length;t++)if(!o(n[t]))return!1;return!0}(n)&&n.length>=a+1}):0===n.length?function(n){return 0===n.length}:1===n.length?(t=K(n[0]),function(n){return t(n[0])&&1===n.length}):2===n.length?(t=K(n[0]),r=K(n[1]),function(n){return t(n[0])&&r(n[1])&&2===n.length}):(e=n.map(K),function(n){for(var t=0;t<e.length;t++)if(!e[t](n[t]))return!1;return n.length===e.length})}function p(n,t){return t<n.params.length?n.params[t]:H(n.params)?v(n.params):null}function s(n,t,r){return((n=p(n,t))?r?n.types.filter(f):n.types:[]).map(o)}function o(n){return n.name}function f(n){return null===n.conversion||void 0===n.conversion}function m(n,t){return-1!==(n=function(n){for(var t={},r=0;r<n.length;r++)t[n[r]]=!0;return Object.keys(t)}(tn(n,function(n){return s(n,t,!1)}))).indexOf("any")?["any"]:n}function l(n,r,t){for(var e=n||"unnamed",a=t,o=0;o<r.length;o++){var i,u,s,f=a.filter(function(n){var t=K(p(n,o));return(o<n.params.length||H(n.params))&&t(r[o])});if(0===f.length){if(0<(s=m(a,o)).length)return i=c(r[o]),(u=new TypeError("Unexpected type of argument in function "+e+" (expected: "+s.join(" or ")+", actual: "+i+", index: "+o+")")).data={category:"wrongType",fn:e,index:o,actual:i,expected:s},u}else a=f}return n=a.map(function(n){return H(n.params)?1/0:n.params.length}),r.length<Math.min.apply(null,n)?(s=m(a,o),(u=new TypeError("Too few arguments in function "+e+" (expected: "+s.join(" or ")+", index: "+r.length+")")).data={category:"tooFewArgs",fn:e,index:r.length,expected:s}):(t=Math.max.apply(null,n),r.length>t?(u=new TypeError("Too many arguments in function "+e+" (expected: "+t+", actual: "+r.length+")")).data={category:"tooManyArgs",fn:e,index:r.length,expectedLength:t}:(u=new TypeError('Arguments of type "'+r.join(", ")+'" do not match any of the defined signatures of function '+e+".")).data={category:"mismatch",actual:r.map(c)}),u}function h(n){for(var t=999,r=0;r<n.types.length;r++)f(n.types[r])&&(t=Math.min(t,n.types[r].typeIndex));return t}function g(n){for(var t=999,r=0;r<n.types.length;r++)f(n.types[r])||(t=Math.min(t,n.types[r].conversionIndex));return t}function W(n,t){var r,e,a,o,i=Math.min(n.params.length,t.params.length),u=n.params.some(J)-t.params.some(J);if(0!==u)return u;for(r=0;r<i;r++)if(0!=(u=J(n.params[r])-J(t.params[r])))return u;for(r=0;r<i;r++)if(e=n.params[r],a=t.params[r],o=void 0,0!==(u=0!=(o=e.restParam-a.restParam)||0!=(o=J(e)-J(a))||0!=(o=h(e)-h(a))?o:g(e)-g(a)))return u;return n.params.length-t.params.length}function X(n){var t,r,e,a,o=[],i=[];switch(n.types.forEach(function(n){n.conversion&&(o.push(u(n.conversion.from).test),i.push(n.conversion.convert))}),i.length){case 0:return function(n){return n};case 1:return t=o[0],e=i[0],function(n){return t(n)?e(n):n};case 2:return t=o[0],r=o[1],e=i[0],a=i[1],function(n){return t(n)?e(n):r(n)?a(n):n};default:return function(n){for(var t=0;t<i.length;t++)if(o[t](n))return i[t](n);return n}}}function Y(n,i){return function t(r,e,a){var n,o;return e<r.length?(o=r[e],n=i?o.types.filter(f):o.types,tn(o.restParam?(o=n.filter(f)).length<n.length?[o,n]:[n]:n.map(function(n){return[n]}),function(n){return t(r,e+1,a.concat([n]))})):[a.map(function(n,t){return{types:n,restParam:t===r.length-1&&H(r)}})]}(n,0,[])}function rn(n,t){for(var r=Math.max(n.params.length,t.params.length),e=0;e<r;e++)if(!function(n,t){for(var r=0;r<n.length;r++)if(function(n,t){return-1!==n.indexOf(t)}(t,n[r]))return 1}(s(n,e,!0),s(t,e,!0)))return!1;var a=n.params.length,o=t.params.length,i=H(n.params),u=H(t.params);return i?u?a===o:a<=o:u?o<=a:a===o}function y(r,e){if(0===Object.keys(e).length)throw new SyntaxError("No signatures provided");function a(n,t){return(arguments.length===S&&h(n)&&x(t)?A:arguments.length===D&&g(n)&&E(t)?M:arguments.length===L&&y(n)&&j(t)?F:arguments.length===U&&d(n)&&O(t)?k:arguments.length===R&&v(n)&&b(t)?I:arguments.length===V&&w(n)&&T(t)?C:function(){for(var n=N;n<q;n++)if(l[n](arguments))return P[n].apply(this,arguments);return z.onMismatch(r,arguments,u)}).apply(a,arguments)}var o,i=[],u=(Object.keys(e).map(function(n){return t=e[n],a=z.conversions,r=[],(r=""!==n.trim()?n.split(",").map(Z).map(function(n,t,r){var e=G(n,a);if(e.restParam&&t!==r.length-1)throw new SyntaxError('Unexpected rest parameter "'+n+'": only allowed for the last parameter');return e}):r).some(en)?null:{params:r,fn:t};var t,a,r}).filter($).forEach(function(t){var n=nn(i,function(n){return rn(n,t)});if(n)throw new TypeError('Conflicting signatures "'+B(n.params)+'" and "'+B(t.params)+'".');i.push(t)}),tn(i,function(t){return(t?Y(t.params,!1):[]).map(function(n){return{params:n,fn:t.fn}})}).filter($)),n=(u.sort(W),u[0]&&u[0].params.length<=2&&!H(u[0].params)),t=u[1]&&u[1].params.length<=2&&!H(u[1].params),s=u[2]&&u[2].params.length<=2&&!H(u[2].params),f=u[3]&&u[3].params.length<=2&&!H(u[3].params),c=u[4]&&u[4].params.length<=2&&!H(u[4].params),p=u[5]&&u[5].params.length<=2&&!H(u[5].params),m=n&&t&&s&&f&&c&&p,l=u.map(function(n){return Q(n.params)}),h=n?K(u[0].params[0]):an,g=t?K(u[1].params[0]):an,y=s?K(u[2].params[0]):an,d=f?K(u[3].params[0]):an,v=c?K(u[4].params[0]):an,w=p?K(u[5].params[0]):an,x=n?K(u[0].params[1]):an,E=t?K(u[1].params[1]):an,j=s?K(u[2].params[1]):an,O=f?K(u[3].params[1]):an,b=c?K(u[4].params[1]):an,T=p?K(u[5].params[1]):an,P=u.map(function(n){return t=n.params,e=n.fn,i=e,t.some(J)&&(a=H(t),o=t.map(X),i=function(){for(var n=[],t=a?arguments.length-1:arguments.length,r=0;r<t;r++)n[r]=o[r](arguments[r]);return a&&(n[t]=arguments[t].map(o[t])),e.apply(this,n)}),n=i,H(t)&&(r=t.length-1,n=function(){return i.apply(this,_(arguments,0,r).concat([_(arguments,r)]))}),n;var t,e,a,o,r,i}),A=n?P[0]:on,M=t?P[1]:on,F=s?P[2]:on,k=f?P[3]:on,I=c?P[4]:on,C=p?P[5]:on,S=n?u[0].params.length:-1,D=t?u[1].params.length:-1,L=s?u[2].params.length:-1,U=f?u[3].params.length:-1,R=c?u[4].params.length:-1,V=p?u[5].params.length:-1,N=m?6:0,q=u.length;try{Object.defineProperty(a,"name",{value:r})}catch(n){}return a.signatures=(o={},u.forEach(function(t){t.params.some(J)||Y(t.params,!0).forEach(function(n){o[B(n)]=t.fn})}),o),a}function d(n,t,r){throw l(n,t,r)}function E(n){return-1===z.ignore.indexOf(n)}function Z(n){return n.trim()}function j(n){return!!n}function $(n){return null!==n}function en(n){return 0===n.types.length}function v(n){return n[n.length-1]}function _(n,t,r){return Array.prototype.slice.call(n,t,r)}function nn(n,t){for(var r=0;r<n.length;r++)if(t(n[r]))return n[r]}function tn(n,t){return Array.prototype.concat.apply([],n.map(t))}function w(n){for(var t="",r=0;r<n.length;r++){var e,a=n[r];if(("object"==typeof a.signatures||"string"==typeof a.signature)&&""!==a.name)if(""===t)t=a.name;else if(t!==a.name)throw(e=new Error("Function names do not match (expected: "+t+", actual: "+a.name+")")).data={actual:a.name,expected:t},e}return t}function x(n){var r,e={};function t(n,t){if(e.hasOwnProperty(n)&&t!==e[n])throw(r=new Error('Signature "'+n+'" is defined twice')).data={signature:n},r}for(var a=0;a<n.length;a++){var o=n[a];if("object"==typeof o.signatures)for(var i in o.signatures)o.signatures.hasOwnProperty(i)&&(t(i,o.signatures[i]),e[i]=o.signatures[i]);else{if("string"!=typeof o.signature)throw(r=new TypeError("Function is no typed-function (index: "+a+")")).data={index:a},r;t(o.signature,o),e[o.signature]=o}}return e}return(z=y("typed",{"string, Object":y,Object:function(n){var t,r=[];for(t in n)n.hasOwnProperty(t)&&r.push(n[t]);return y(w(r),n)},"...Function":function(n){return y(w(n),x(n))},"string, ...Function":function(n,t){return y(n,x(t))}})).create=n,z.types=t,z.conversions=a,z.ignore=e,z.onMismatch=d,z.throwMismatchError=d,z.createError=l,z.convert=function(n,t){var r=c(n);if(t===r)return n;for(var e=0;e<z.conversions.length;e++){var a=z.conversions[e];if(a.from===r&&a.to===t)return a.convert(n)}throw new Error("Cannot convert from "+r+" to "+t)},z.find=function(n,t){if(!n.signatures)throw new TypeError("Function is no typed-function");if("string"==typeof t)for(var r=t.split(","),e=0;e<r.length;e++)r[e]=r[e].trim();else{if(!Array.isArray(t))throw new TypeError("String array or a comma separated string expected");r=t}if(t=r.join(","),t=n.signatures[t])return t;throw new TypeError("Signature not found (signature: "+(n.name||"unnamed")+"("+r.join(", ")+"))")},z.addType=function(n,t){if(!n||"string"!=typeof n.name||"function"!=typeof n.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==t)for(var r=0;r<z.types.length;r++)if("Object"===z.types[r].name)return void z.types.splice(r,0,n);z.types.push(n)},z.addConversion=function(n){if(!n||"string"!=typeof n.from||"string"!=typeof n.to||"function"!=typeof n.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");z.conversions.push(n)},z}()});